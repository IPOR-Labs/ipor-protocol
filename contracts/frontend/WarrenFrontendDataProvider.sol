// SPDX-License-Identifier: agpl-3.0
pragma solidity 0.8.9;

import "@openzeppelin/contracts-upgradeable/proxy/utils/UUPSUpgradeable.sol";
import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";
import "../security/IporOwnableUpgradeable.sol";
import "../interfaces/IWarrenFrontendDataProvider.sol";
import {Constants} from "../libraries/Constants.sol";
import {IporMath} from "../libraries/IporMath.sol";
import "../interfaces/IWarren.sol";

contract WarrenFrontendDataProvider is
    IporOwnableUpgradeable,
    UUPSUpgradeable,
    IWarrenFrontendDataProvider
{
    address private _warren;
    address[] internal _assets;

    function initialize(address[] memory assets, address warren) public initializer {
        __Ownable_init();
        _warren = warren;

        // address[] assetsMem = address[assets.length];

        // uint256 i = 0;
        // for (i; i != assets.length; i++) {
        //     _config[assets[i]] = IporConfig(miltons[i], miltonStorages[i]);
        //     assetsMem[i] = assets[i];
        // }
        // _assets = assetsMem;

        _assets = assets;
    }

    function getIndexes() external view override returns (IporFront[] memory) {
        IporFront[] memory indexes = new IporFront[](_assets.length);

        uint256 i = 0;
        for (i; i != _assets.length; i++) {
            indexes[i] = _createIporFront(_assets[i]);
        }
        return indexes;
    }

    function _createIporFront(address asset) internal view returns (IporFront memory iporFront) {
        (uint256 value, uint256 ibtPrice, , , uint256 date) = IWarren(_warren).getIndex(asset);
        iporFront = IporFront(IERC20MetadataUpgradeable(asset).symbol(), value, ibtPrice, date);
    }

    function _authorizeUpgrade(address) internal override onlyOwner {}
}
